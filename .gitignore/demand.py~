# this calculates the base growth rate g(t) 
import pandas as pd 

TAX_RATE = 0.08;

def base_growth(start_year, end_year):
    df = pd.read_csv(
        't2data.csv',
        comment='#',
        skiprows=7,
        header=None
    )

    # Assign correct column names for Alaska table
    df.columns = [
        'Year',
        'Tourist count (million)',
        'Winter tourists',
        'Winter share'
    ]

    # Convert to numeric and drop garbage rows
    df['Year'] = pd.to_numeric(df['Year'], errors='coerce')
    df['Tourist count (million)'] = pd.to_numeric(
        df['Tourist count (million)'], errors='coerce'
    )
    df = df.dropna(subset=['Year', 'Tourist count (million)'])

    # Extract values
    T_start = df.loc[df['Year'] == start_year, 'Tourist count (million)'].iloc[0]
    T_end   = df.loc[df['Year'] == end_year,   'Tourist count (million)'].iloc[0]

    n = end_year - start_year
    return (T_end / T_start) ** (1 / n) - 1

def base_tourism_demand_eqn(year, demand_elasticity, g_base, tax_rate=TAX_RATE):
    """
    Computes T(year) using:
    T(t) = T(t-1) * (1 + g_base - γ * τ)
    """

    df = pd.read_csv('t2data.csv', comment='#', nrows=5)
    df['Year'] = df['Year'].astype(int)

    # Get T(t-1)
    prev_year = year - 1
    T_prev = df.loc[df['Year'] == prev_year, 'Tourist count (million)'].iloc[0]

    # Apply demand equation
    T_curr = T_prev * (1 + g_base - demand_elasticity * tax_rate)

    return T_curr

def main():
    g_base = base_growth(2006, 2023)
    gamma = 0.3

    T_2024 = base_tourism_demand_eqn(
        year=2024,
        demand_elasticity=gamma,
        g_base=g_base
    )

    print(f" 2024 tourism: {T_2024:.3f} million")

if __name__ == "__main__":
    main()
